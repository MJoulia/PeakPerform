<!-- src/app/task/task.component.html -->
<app-navbar></app-navbar>

<app-navbarvertical></app-navbarvertical>


  
<main class="main-content">
  <h1>Task</h1>
  <section class="cards">
    <!-- Cartes générées dynamiquement -->
    <div
      class="card"
      [ngClass]="project.colorClass"
      *ngFor="let project of items; let i = index"
    >

    <!-- Icône SVG en haut à gauche -->
    
     

    <!-- Icône SVG en haut à droite -->
    <div class="card-menu" 
      (mouseenter)="onMouseEnter(i)">
      <a [routerLink]="['/taskpage' ,project[0]]">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots" viewBox="0 0 16 16">
        <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"/>
      </svg>
    </a>
      <div *ngIf="showTooltip[i]" class="tool">
        <small>More information</small>
      </div>
    </div>

    <!-- Contenu de la carte -->
      <!--<div
        class="card-plus"
        (mouseenter)="onMouseEnter(i)"
        (mouseleave)="onMouseLeave(i)"
      >
        +
        
        <div *ngIf="showTooltip[i]" class="tool">
          <small>More information</small>
        </div>
      </div>-->
      <h2 class="card-title">{{ project[0]}}</h2>
      <!--<p><strong>ID:</strong> {{ project.id }}</p>-->
      <!--<p><strong>Description:</strong> {{ project.description }}</p>-->
      <p><strong>Deadline:</strong> {{ project[1] }}</p>
      <p><strong>Date Created:</strong> {{ project[2] | date: 'short' }}</p>
    </div>
  </section>
</main>

  <!-- Bouton flottant en bas à droite -->
  <button class="add-button" (click)="openDialog()">+</button>
  
<!-- Modal (shows if showModal === true) -->
@if (showDialog) {
    <!-- MODAL -->
<div class="dialog-backdrop" (click)="closeDialog()">
    <div class="dialog-content" (click)="$event.stopPropagation()">
      
      <h2>Create a New Task</h2>
      
      <div class="dialog-body">
        <!-- LEFT COLUMN -->
        <div class="left-col">
          <!-- Task name -->
          <div class="form-group">
            <label for="taskName">Task Name</label>
            <input 
              id="taskName" 
              [(ngModel)]="taskName" 
              placeholder="Enter task name"
            />
          </div>
  
          <!-- Description -->
          <div class="form-group">
            <label for="desc">Description</label>
            <textarea 
              id="desc" 
              rows="2" 
              [(ngModel)]="taskDescription"
              placeholder="Short description"
            ></textarea>
          </div>
  
          <!-- Effects (eight) -->
          <div class="form-group effects-group">
            <label>Effects (0-100%)</label>
            <mat-form-field>
              <mat-label>Employee Qualifications</mat-label>
              <mat-select [(ngModel)]="selectedQualification">
                <mat-option *ngFor="let qualif of qualifications" [value]="qualif.value">
                  {{ qualif.viewValue }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Working environment</mat-label>
              <mat-select [(ngModel)]="selectedWorkenv">
                <mat-option *ngFor="let wenv of working_environment" [value]="wenv.value">
                  {{ wenv.viewValue }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            
            <mat-form-field>
              <mat-label>Quality management</mat-label>
              <mat-select [(ngModel)]="selectedQuality">
                <mat-option *ngFor="let qualit of qualities" [value]="qualit.value">
                  {{ qualit.viewValue }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            
            <mat-form-field>
              <mat-label>Lead Time</mat-label>
              <mat-select [(ngModel)]="selectedLeadtime">
                <mat-option *ngFor="let leadt of lead_time" [value]="leadt.value">
                  {{ leadt.viewValue }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            
            <mat-form-field>
              <mat-label>Capacity</mat-label>
              <mat-select [(ngModel)]="selectedCapacity">
                <mat-option *ngFor="let cap of capacity" [value]="cap.value">
                  {{ cap.viewValue }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            
            <mat-form-field>
              <mat-label>Economic Situation</mat-label>
              <mat-select [(ngModel)]="selectedEconomic">
                <mat-option *ngFor="let eco of economics" [value]="eco.value">
                  {{ eco.viewValue }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            
            <mat-form-field>
              <mat-label>Independence from suppliers</mat-label>
              <mat-select [(ngModel)]="selectedIndependance">
                <mat-option *ngFor="let indep of independences" [value]="indep.value">
                  {{ indep.viewValue }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            
            <mat-form-field>
              <mat-label>Equity capital</mat-label>
              <mat-select [(ngModel)]="selectedCapital">
                <mat-option *ngFor="let capi of capital" [value]="capi.value">
                  {{ capi.viewValue }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            
          </div>
          
          
  
          <!-- Subtasks: input + add -->
          <!-- <div class="subtasks-section">
            <label>Subtasks</label>
            <div class="subtask-input">
              <input 
                [(ngModel)]="newSubtask" 
                placeholder="Add a subtask"
              />
              <button type="button"  (click)="addSubtask()">Add</button>
            </div>
          </div> -->
        </div>
         <!-- RIGHT COLUMN: list of added subtasks  -->
        <!-- <div class="right-col">
          <h3>Subtasks Added</h3>
          <ul>
            @for(s of subtasks; track s) {<li >{{ s }}</li>}
          </ul>
        </div> -->
      </div>
  
      <!-- ACTIONS: Save and Cancel -->
      <div class="dialog-actions">
        <button type="button" (click)="closeDialog()">Cancel</button>
        <button type="button" (click)="saveTask()">Save</button>
      </div>
    </div>
  </div>
}
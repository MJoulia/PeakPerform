<!-- src/app/task/task.component.html -->
<app-navbar></app-navbar>

<app-navbarvertical></app-navbarvertical>


  
<main class="main-content">
  <h1>Task</h1>
  <section class="cards">
    <!-- Cartes générées dynamiquement -->
    <div
      class="card"
      [ngClass]="project.colorClass"
      *ngFor="let project of items; let i = index"
    >

    <!-- Icône SVG en haut à gauche -->
    
      <a (click)="confirmNavigation($event)" class="card-icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-archive" viewBox="0 0 16 16">
        <path d="M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5zm13-3H1v2h14zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"/>
      </svg>
    </a>

    <!-- Icône SVG en haut à droite -->
    <div class="card-menu" 
      (mouseenter)="onMouseEnter(i)"
      (mouseleave)="onMouseLeave(i)">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots" viewBox="0 0 16 16">
        <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"/>
      </svg>
      <div *ngIf="showTooltip[i]" class="tool">
        <small>More information</small>
      </div>
    </div>

    <!-- Contenu de la carte -->
      <!--<div
        class="card-plus"
        (mouseenter)="onMouseEnter(i)"
        (mouseleave)="onMouseLeave(i)"
      >
        +
        
        <div *ngIf="showTooltip[i]" class="tool">
          <small>More information</small>
        </div>
      </div>-->
      <h2 class="card-title">{{ project[0]}}</h2>
      <!--<p><strong>ID:</strong> {{ project.id }}</p>-->
      <!--<p><strong>Description:</strong> {{ project.description }}</p>-->
      <p><strong>Deadline:</strong> {{ project[1] }}</p>
      <p><strong>Date Created:</strong> {{ project[2] | date: 'short' }}</p>
    </div>
  </section>
</main>

  <!-- Bouton flottant en bas à droite -->
  <button class="add-button" (click)="openDialog()">+</button>
  
<!-- Modal (shows if showModal === true) -->
@if (showDialog) {
    <!-- MODAL -->
<div class="dialog-backdrop" (click)="closeDialog()">
    <div class="dialog-content" (click)="$event.stopPropagation()">
      
      <h2>Create a New Task</h2>
      
      <div class="dialog-body">
        <!-- LEFT COLUMN -->
        <div class="left-col">
          <!-- Task name -->
          <div class="form-group">
            <label for="taskName">Task Name</label>
            <input 
              id="taskName" 
              [(ngModel)]="taskName" 
              placeholder="Enter task name"
            />
          </div>
  
          <!-- Description -->
          <div class="form-group">
            <label for="desc">Description</label>
            <textarea 
              id="desc" 
              rows="2" 
              [(ngModel)]="taskDescription"
              placeholder="Short description"
            ></textarea>
          </div>
  
          <!-- Effects (eight) -->
          <div class="form-group effects-group">
            <label>Effects (0-100%)</label>
            <mat-form-field>
              <mat-label>Employee qualifications</mat-label>
              <mat-select>
                @for (qualif of qualifications; track qualif) {
                  <mat-option [value]="qualif.value">{{qualif.viewValue}}</mat-option>
                }
              </mat-select>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Working environment</mat-label>
              <mat-select>
                @for (wenv of working_environment; track wenv) {
                  <mat-option [value]="wenv.value">{{wenv.viewValue}}</mat-option>
                }
              </mat-select>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Quality management</mat-label>
              <mat-select>
                @for (qualit of qualities; track qualit) {
                  <mat-option [value]="qualit.value">{{qualit.viewValue}}</mat-option>
                }
              </mat-select>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Lead Time</mat-label>
              <mat-select>
                @for (leadt of lead_time; track leadt) {
                  <mat-option [value]="leadt.value">{{leadt.viewValue}}</mat-option>
                }
              </mat-select>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Capacity</mat-label>
              <mat-select>
                @for (cap of capacity; track cap) {
                  <mat-option [value]="cap.value">{{cap.viewValue}}</mat-option>
                }
              </mat-select>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Economic Situation</mat-label>
              <mat-select>
                @for (eco of economics; track eco) {
                  <mat-option [value]="eco.value">{{eco.viewValue}}</mat-option>
                }
              </mat-select>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Independence from suppliers</mat-label>
              <mat-select>
                @for (indep of independences; track indep) {
                  <mat-option [value]="indep.value">{{indep.viewValue}}</mat-option>
                }
              </mat-select>
            </mat-form-field>
            <mat-form-field>
              <mat-label>Equity capital</mat-label>
              <mat-select>
                @for (capi of capital; track capi) {
                  <mat-option [value]="capi.value">{{capi.viewValue}}</mat-option>
                }
              </mat-select>
            </mat-form-field>
          </div>
          
          
  
          <!-- Subtasks: input + add -->
          <div class="subtasks-section">
            <label>Subtasks</label>
            <div class="subtask-input">
              <input 
                [(ngModel)]="newSubtask" 
                placeholder="Add a subtask"
              />
              <button type="button"  (click)="addSubtask()">Add</button>
            </div>
          </div>
        </div>
        
        <!-- RIGHT COLUMN: list of added subtasks -->
        <div class="right-col">
          <h3>Subtasks Added</h3>
          <ul>
            @for(s of subtasks; track s) {<li >{{ s }}</li>}
          </ul>
        </div>
      </div>
  
      <!-- ACTIONS: Save and Cancel -->
      <div class="dialog-actions">
        <button type="button" (click)="closeDialog()">Cancel</button>
        <button type="button" (click)="saveTask()">Save</button>
      </div>
    </div>
  </div>
}

  